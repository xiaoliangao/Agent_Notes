Agent：让AI不仅是一个“有问必答”的工具，而是一个能自主规划、调用工具、解决复杂问题的“行动者”

## 第一部分 基础篇

### 第一章：初识智能体

#### 1.1 什么是智能体

如何理解智能体：在AI领域内通过Sensors感知所处环境，==自主==调用执行器（封装好的工具？）执行任务的实体

**四要素：传感器、环境、执行器、行动**

**状态：** 任意特定时刻所拥有的所有信息和记忆的快照，是执行下一步决策的唯一依据。其具体构成，取决于 Agent 的设计和它所处的环境。

发展历程：反射智能体 —> 基于模型的反射智能体 —> 基于目标的智能体 —> 基于效用的智能体

传统智能体的能力源于工程师的显式编程与知识构建，其行为模式是确定且有边界的；而 LLM 智能体则通过在海量数据上的预训练，获得了隐式的世界模型与强大的涌现能力，使其能够以更灵活、更通用的方式应对复杂任务。

一个智能体的工作流程：

- 规划和推理：将高层级目标分解为一系列逻辑子任务
- 工具使用：执行规划时，智能体识别到信息缺口，会主动调用外部工具来补全
- 动态修正：会根据用户提供的反馈作为新的约束，并据此调整后续的行动，重新搜索并推荐符合新要求的选项

**智能体分类：**

- 基于内部决策架构的分类：依据智能体内部决策架构的复杂程度
- 基于时间和反应性的分类：关注点是接收到信息后立即行动还是会经过深思熟虑的规划再行动（规划：思考阶段，规划下一步的合理活动；反应：在行动和观察阶段，智能体和环境进行交互并立即获得反馈）
  - 反应式：速度快、计算开销低，不需要规划
  - 规划式：要求最优解或者尽可能优，不追求速度
  - 混合式：追求反应和规划的平衡

![image-20251110145900873](/Users/yyyy/Library/Application Support/typora-user-images/image-20251110145900873.png)

- 基于知识表示的分类：
  - 符号主义：优势—透明、可解释；缺点：知识获取瓶颈
  - 亚符号主义：优势：模式识别能力和对噪声数据的鲁棒性；缺点：逻辑性欠佳
  - 神经符号主义：一个既能像神经网络一样从数据中学习，又能像符号系统一样进行逻辑推理的混合智能体

![image-20251110153546763](/Users/yyyy/Library/Application Support/typora-user-images/image-20251110153546763.png)

#### 1.2 智能体的构成与运行原理

对**任务环境**的理解：**是 Agent 完成其任务时所处的“问题域”或“世界”**。它定义了 Agent 运行的上下文，规定了 Agent 能**感知**什么、能**执行**什么，以及衡量其**成功与否**的标准。

状态是 Agent 的**内部**快照，而任务环境则是 Agent **外部**的、需要去交互和解决的客观世界。

**PEAS框架：**

- **P (Performance Measure) - 性能度量：**

  - **“如何评判 Agent 做得好不好？”**

  - 这是一个用于评估 Agent 行为成功与否的客观标准。

  - 示例： 扫地机器人的性能度量是“单位时间内的清洁覆盖率”或“总清洁时间”。

- **E (Environment) - 环境：**

  - **“Agent 在哪里工作？”**

  - 这是 Agent 感知和行动的“世界”。它包含了 Agent 之外的一切。

  - 示例： 扫地机器人的环境是“房间、地板、家具、地毯、灰尘”。

- **A (Actuators) - 执行器：**

  - **“Agent 如何对环境施加影响？”**

  - 这是 Agent 用来执行动作的“手和脚”。

  - 示例： 扫地机器人的执行器是“轮子（移动）、吸尘器（吸尘）、边刷（清扫）”。

- **S (Sensors) - 传感器：**

  - **“Agent 如何感知环境？”**

  - 这是 Agent 用来获取环境“状态”信息的“眼睛和耳朵”。

  - 示例： 扫地机器人的传感器是“摄像头、红外传感器（感知障碍物）、碰撞传感器、灰尘传感器”。

**智能体运行核心机制：**智能体循环（一个持续的循环与环境进行交互：进行循环的原因是Action会造成环境的状态变化，就会产生新的Observation，进而进行下一轮的循环）

![image-20251110180103705](/Users/yyyy/Library/Application Support/typora-user-images/image-20251110180103705.png)

Agent Loop ：**交互协议**（Thought、Action）+ Observation

```
Thought：用户想知道北京的天气。我需要调用天气查询工具
Action：get_weather（“北京”）
Observation：北京当前天气为晴，气温25摄氏度，微风。Action执行后会得到一个Observation
```

#### 1.4 智能体应用的协作模式

- 作为工具，融入工作流：增强而非取代开发者的角色，通过自动化处理繁琐、重复的任务，让开发者能更专注于创造性的核心工作
- 作为自主的协作者，与其他智能体协作完成：独立地进行规划、推理、执行和反思，直到最终交付成果
  - 单智能体自主循环：一个通用智能体通过“思考-规划-执行-反思”的闭环，不断进行自我提示和迭代，以完成一个开放式的高层级目标
  - 多智能体协作：模拟人类团队的协作模式来解决复杂问题
  - 高级控制流架构：于为智能体提供更强大的底层工程基础

**工作流和Agent的差异：**Workflow 是让 AI 按部就班地执行指令，而 Agent 则是赋予 AI 自由度去自主达成目标。

个人理解：Workflow 就是规定好每一步做什么；但Agent只需要提供工具，给出目标，让LLM判断如何执行

#### 习题

1. 请分析以下四个 `case` 中的**主体**是否属于智能体，如果是，那么属于哪种类型的智能体（可以从多个分类维度进行分析），并说明理由：

   `case A`：**一台符合冯·诺依曼结构的超级计算机**，拥有高达每秒 2EFlop 的峰值算力

   `case B`：**特斯拉自动驾驶系统**在高速公路上行驶时，突然检测到前方有障碍物，需要在毫秒级做出刹车或变道决策

   `case C`：**AlphaGo**在与人类棋手对弈时，需要评估当前局面并规划未来数十步的最优策略

   `case D`：**ChatGPT 扮演的智能客服**在处理用户投诉时，需要查询订单信息、分析问题原因、提供解决方案并安抚用户情绪

   ```
   - A：不是
   - B：是，反应
   - C：规划
   - D：混合
   ```

2. 假设你需要为一个"智能健身教练"设计任务环境。这个智能体能够：

   - 通过可穿戴设备监测用户的心率、运动强度等生理数据
   - 根据用户的健身目标（减脂/增肌/提升耐力）动态调整训练计划
   - 在用户运动过程中提供实时语音指导和动作纠正
   - 评估训练效果并给出饮食建议

   请使用 PEAS 模型完整描述这个智能体的任务环境，并分析该环境具有哪些特性（如部分可观察、随机性、动态性等）。

   ```
   - P：健康指标
   - E：身体状态
   - A：建议系统
   - S：设备
   
   - 部分可观察：无法实时完全获知用户状态
   - 随机性：用户反应和传感器读数具有不确定性
   - 动态性：状态随时改变
   ```

3. 某电商公司正在考虑两种方案来处理售后退款申请：

   方案 A（`Workflow`）：设计一套固定流程，例如：

   A.1 对于一般商品且在 7 天之内，金额 `< 100RMB` 自动通过；`100-500RMB `由客服审核；`>500RMB` 需主管审批；而特殊商品（如定制品）一律拒绝退款

   A.2 对于超过 7 天的商品，无论金额，只能由客服审核或主管审批；

   方案 B（`Agent`）：搭建一个智能体系统，让它理解退款政策、分析用户历史行为、评估商品状况，并自主决策是否批准退款

   请分析：

   - 这两种方案各自的优缺点是什么？
   - 在什么情况下 `Workflow` 更合适？什么情况下 `Agent` 更有优势？如果你是该电商公司的负责人，你更倾向于采用哪种方案？
   - 是否存在一个方案 C，能够结合两种方案，达到扬长避短的效果？

   ```
   优缺点：
   - 简单、可控、易审计；适合规则清晰的场景
   - 缺乏灵活性，无法处理复杂或模糊情况；维护成本高
   
   - 可学习与适应；处理非结构化数据能力强；自动化程度高
   - 逻辑差，难以完全可解释，可能出现误判
   
   阶段 1：Workflow 筛选简单案件（金额、时间等规则）
   阶段 2：复杂或模糊案件 → Agent 分析情境（文本、图片、历史行为）
   阶段 3：Agent 决策结果通过 Workflow 审核层控制风险
   ```

4. 在 1.3 节的智能旅行助手基础上，请思考如何添加以下功能（可以只描述设计思路，也可以进一步尝试代码实现）：

   > **提示**：思考如何修改 `Thought-Action-Observation` 循环来实现这些功能。

   - 添加一个"记忆"功能，让智能体记住用户的偏好（如喜欢历史文化景点、预算范围等）
   - 当推荐的景点门票已售罄时，智能体能够自动推荐备选方案
   - 如果用户连续拒绝了 3 个推荐，智能体能够反思并调整推荐策略

   ```
   - 引入长期记忆模块存储偏好向量（如文化景点偏好、预算）
   - 增加状态检测逻辑(检查票务)
   - 添加反馈计数与反思机制
   ```

5. 卡尼曼的"系统 1"（快速直觉）和"系统 2"（慢速推理）理论[2]为神经符号主义 AI 提供了很好的类比。请首先构思一个具体的智能体的落地应用场景，然后说明场景中的：

   > **提示**：医疗诊断助手、医疗诊断助手、金融风控系统等都是常见的应用场景

   - 哪些任务应该由"系统 1"处理？
   - 哪些任务应该由"系统 2"处理？
   - 这两个系统如何协同工作以达成最终目标？

   ```
   - 金融风控系统
   - 医疗诊断助手、医疗诊断助手
   - 系统1输出候选结果 → 系统2进行解释性验证与综合决策
   ```

6. 尽管大语言模型驱动的智能体系统展现出了强大的能力，但它们仍然存在诸多局限。请分析以下问题：

   - 为什么智能体或智能体系统有时会产生"幻觉"（生成看似合理但实际错误的信息）？
   - 在 1.3 节的案例中，我们设置了最大循环次数为 5 次。如果没有这个限制，智能体可能会陷入什么问题？
   - 如何评估一个智能体的"智能"程度？仅使用准确率指标是否足够？

   ```
   - 缺乏事实约束,知识库没有更新
   - 可能会一直检索
   - 任务完成程度、交互质量、可解释性、安全与鲁棒性
   ```

   











